NAT和NAPT（PAT）只能对IP报文的头部地址和TCP/UDP头部的端口进行地址转换，对于一些特殊协议，例如ICMP、FTP等，它们报文的数据部分可能包含IP地址和端口信息，这些内容不能被NAT有效地转换，导致出现问题。
例如，一个使用内部IP地址的FTP服务器可能在和外部主机建立会话的过程中，需要将自己的IP地址发送给对方，而这个地址信息是放到IP报文的数据部分，NAT无法对他进行转换。当外部网络主机接收了这个私有地址并使用它，这是将表现为FTP服务器不可达。
解决这些特殊协议的NAT转换问题的方法，就是在NAT实现中使用ALG功能。
ALG是特定应用协议的转换代理，它和NAT交互以建立状态，使用NAT的状态信息来改变封装在IP报文数据部分中的特定数据，并完成其他必须得工作以便使应用协议可以跨越不同范围运行。
例如，考虑一个“目的站点不可达”的ICMP报文，该报文数据部分包含了造成错误的数据报A的首部（注意，NAT发送A之前进行了地址转换，所以源地址不是内部主机的真实地址）。如果开启了ICMP的ALG功能，在NAT转换ICMP报文之前，它将与NAT交互，
打开ICMP报文并转换数据部分的报文A首部的地址，使这些地址表现为内部主机的确切地址形式，并完成其他必须的工作后，由NAT将这个ICMP报文转发出去。
