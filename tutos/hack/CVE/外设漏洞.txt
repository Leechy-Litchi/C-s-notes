https://www.secpulse.com/archives/165937.html
提供一个0day(CVE)挖掘思路（可能）



最近在Twitter看到国外大神jonhat披露的雷蛇的0day漏洞，该漏洞只要接入雷蛇的鼠标或键盘等外设安装驱动就能直接提权到system权限。原文在这里：

https://twitter.com/j0nh4t/status/1429049506021138437

刚好我用的就是雷蛇鼠标，赶紧复现一波（复现视频可以去twitter看原版）。


先在插上一个新的雷蛇设备，或者删除老驱动后再插入，等安装好基本驱动后，会自动弹出安装Razer Synapse（雷云）的安装向导，然后再选择安装位置时，可以新建一个terminal，新建的这个terminal就是system权限



简单分析下漏洞原理，这类外设或其他I/O设备，连接到电脑上时都会有一个驱动安装过程，只是现在都简化了，都是即插即用型，用户感觉不到安装过程。


而驱动级的程序安装与运行都是system权限的，正常过程用户是无法利用的，而雷蛇这个雷云软件，在安装好基本驱动后自动拉起，直接使用的就是驱动程序的system权限，所以造成了提权。


这个漏洞雷蛇这边肯定是有大问题，但是微软这边对这类驱动程序的权限控制有没有问题还是已经在他们某个条款里写到过了就不得而知了。



拓展
在统一软管或者其他内部安装软件的方式，找一个软件进行安装。在安装过程中，选择安装文件夹的过程中，可以新建一个terminal，此时这个terminal就是administrator权限。


最低也是本地administrator权限，也可以是system权限，甚至域管权限。如果只是本地administrator权限也有办法提权到system

